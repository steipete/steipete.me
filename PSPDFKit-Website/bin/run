#!/usr/bin/env bash

set -euxo pipefail

# If running inside Docker, we have to use polling for file watching since inotify events won't work.
if grep -qa '/docker' /proc/1/cgroup; then
    bundle exec middleman server --watcher-force-polling --watcher-latency=1
else
    bundle exec middleman server
fi
