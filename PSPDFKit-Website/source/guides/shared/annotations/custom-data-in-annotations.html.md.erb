---
title: Storing Custom Data in an Annotation
section: developers
---

When adding an annotation to a document, PSPDFKit allows storing of additional data that you can specify for each annotation. This data is persistently stored along with the annotation if the annotation is stored in one of the following formats:

1.  Embedded in the PDF
2.  [Instant JSON][]
3.  [XFDF][]
    <% if ios? %>
4.  `NSCoding`-based serialization of [`PSPDFAnnotation`][]
    <% end %>

PSPDFKit automatically handles the serialization of the custom data attached to an annotation for these formats.

## Storing Custom Data

<% if ios? %>

[PSPDFKit 8.3 for iOS][] added the [`customData`][] property to [`PSPDFAnnotation`][]. This property allows you to store an arbitrary JSON-compliant dictionary in an annotation, like so:

[==

```swift
let restaurantInfo: [String: Any] = [
    "name": "Grill House",
    "locations": ["Vienna", "Paris", "New York"],
    "rating": 5,
    "verified": true
]

// The `customData` property is available on all subclasses of `PSPDFAnnotation`.
annotation.customData = restaurantInfo
```

```objc
NSDictionary<NSString *, id> *restaurantInfo = @{
    @"name": @"Grill House",
    @"locations": @[@"Vienna", @"Paris", @"New York"],
    @"rating": @5,
    @"verified": @YES
};

// The `customData` property is available on all subclasses of `PSPDFAnnotation`.
annotation.customData = restaurantInfo
```

==]

This dictionary is saved to the annotation provider that the annotation belongs to when the document is saved. PSPDFKit does not use this property internally for any reason; you have complete control over its contents.

In addition, the dictionary can only have `NSString` keys, and all its values must be serializable to JSON — that is, they must be of the type `NSString`, `NSNumber`, `NSDictionary`, `NSArray`, or `NSNull`. The numbers should not be `NaN` or infinity. If calling [`+[NSJSONSerialization isValidJSONObject:]`][isvalidjsonobject] on the dictionary does not return `true`, setting it to [`customData`][] will result in an exception being raised.

In addition to PSPDFKit’s automated handling of `customData` when stored to the locations mentioned above, `customData` is also serialized when using [`NSKeyedArchiver`][] or [`-[PSPDFAnnotation generateInstantJSONWithError:]`][generateinstantjsonwitherror].

<% end %>

<% if android? %>

[PSPDFKit 5.3 for Android][] added the [`setCustomData()`][] method to [`Annotation`][]. This allows you to store arbitrary data in an annotation in the form of a [`JSONObject`][], like so:

[==

```kotlin
val restaurantInfo = JSONObject()
    .put("name", "Grill House")
    .put("locations", JSONArray(listOf("Vienna", "Paris", "New York")))
    .put("rating", 5)
    .put("verified", true)

// The `customData` property is available on all subclasses of `Annotation`.
annotation.customData = restaurantInfo
```

```java
JSONObject restaurantInfo = new JSONObject()
    .put("name", "Grill House")
    .put("locations", new JSONArray(Arrays.asList("Vienna", "Paris", "New York")))
    .put("rating", 5)
    .put("verified", true);


// The `customData` property is available on all subclasses of `Annotation`.
annotation.setCustomData(restaurantInfo);
```

==]

This JSON object is saved with the annotation when the document is saved. PSPDFKit does not use this property internally for any reason; you have complete control over its contents.

<% end %>

<% if web? %>

[PSPDFKit for Web 2019.2][] added the [`customData` property to `PSPDFKit.Annotations.Annotation`][customdata]. This property allows you to store an arbitrary JSON-compliant dictionary in an annotation, like so:

[==

```javascript
const updatedAnnotation = annotation.set("customData", {
  name: "Grill House",
  locations: ["Vienna", "Paris", "New York"],
  rating: 5,
  verified: true
});

instance.updateAnnotation(updatedAnnotation);
```

==]

<% end %>

<% if ios? %>

[instant json]: https://pspdfkit.com/guides/ios/current/importing-exporting/instant-json/
[xfdf]: https://pspdfkit.com/guides/ios/current/importing-exporting/xfdf-support/
[pspdfkit 8.3 for ios]: https://pspdfkit.com/blog/2019/pspdfkit-ios-8-3/
[`customdata`]: https://pspdfkit.com/api/ios/Classes/PSPDFAnnotation.html#/c:objc(cs)PSPDFAnnotation(py)customData
[generateinstantjsonwitherror]: https://pspdfkit.com/api/ios/Classes/PSPDFAnnotation.html#/c:objc(cs)PSPDFAnnotation(cm)annotationFromInstantJSON:documentProvider:error:
[isvalidjsonobject]: https://developer.apple.com/documentation/foundation/nsjsonserialization/1418461-isvalidjsonobject?language=objc
[`nskeyedarchiver`]: https://developer.apple.com/documentation/foundation/nskeyedarchiver

<% end %>

<% if android? %>

[instant json]: https://pspdfkit.com/guides/android/current/importing-exporting/instant-json/
[xfdf]: https://pspdfkit.com/guides/android/current/importing-exporting/xfdf-support/
[`jsonobject`]: https://developer.android.com/reference/org/json/JSONObject
[pspdfkit 5.3 for android]: https://pspdfkit.com/blog/2019/pspdfkit-android-5-3/
[`setcustomdata()`]: https://pspdfkit.com/api/android/reference/com/pspdfkit/annotations/Annotation.html#setCustomData(org.json.JSONObject)

<% end %>

<% if web? %>

[instant json]: https://pspdfkit.com/guides/web/current/importing-exporting/instant-json/
[xfdf]: https://pspdfkit.com/guides/web/current/importing-exporting/xfdf-support/
[pspdfkit for web 2019.2]: https://pspdfkit.com/blog/2019/pspdfkit-web-2019-2/
[customdata]: https://pspdfkit.com/api/web/PSPDFKit.Annotations.Annotation.html#customData

<% end %>
